MinimapFlag < UIWidget
  *!mobile size: 11sp 11sp
  *mobile size: 16sp 16sp
  focusable: false
  z-index: 2
  icon-color: #ffffff
  icon-size-unit: sp

  @custom-state canEnter true

  $!canEnter:
    icon-color: #999999

MinimapCross < UIWidget
  id: cross
  focusable: false
  image-source: /assets/images_ui/game/minimap/cross
  image-source: images/trainer
  size: 16sp 16sp
  free-position: true
  z-index: 8

MinimapCrossParty < MinimapCross
  id: crossParty
  size: 8sp 8sp
  image-source: /assets/images_ui/game/minimap/cross
  anchors.horizontalCenter: parent.horizontalGrid-2/4
  icon-clip: 4 4 8 8
  z-index: 5

MinimapButton < UIButton.hover-hand
  *!mobile size: 29sp 30sp
  *mobile size: 44sp 45sp
  image-source: /assets/images_ui/game/minimap/button_small
  image-color: image-opacity-idle
  *mobile image-size: 29sp 30sp
  *mobile image-align: center
  icon-color: pallet-idle

  $hover:
    image-color: image-opacity-hover
    icon-color: pallet-hover
  @transition icon-color: 0.2s cubic ease-out
  @transition image-color: 0.2s cubic ease-out

BigMinimapButton < UIButton.hover-hand
  *!mobile size: 40sp 40sp
  *mobile size: 50sp 50sp
  image-source: /assets/images_ui/game/minimap/button_big
  image-color: image-opacity-idle
  *mobile image-size: 40sp 40sp
  *mobile image-align: center
  icon-color: pallet-idle

  $hover:
    image-color: image-opacity-hover
    icon-color: pallet-hover
  @transition icon-color: 0.2s cubic ease-out
  @transition image-color: 0.2s cubic ease-out

GameMinimap < UIGameMinimap
  draggable: true
  focusable: false
  background-color: #111
  margin: 7sp 2sp 5sp 2sp
  min-zoom: 2
  zoom: 3
  max-zoom: 4
  multifloor: true
  clipping: true

  $checked:
    background-color: #111111bb
    margin: 0sp

Minimap < UIWindow
  id: gameMinimapWindow
  *!mobile size: 243sp 249sp
  *mobile size: 203sp 209sp
  anchors.top: parent.top
  anchors.right: parent.right
  margin: 8sp
  focusable: false
  draggable: false
  on: false

  @forward-state on

  $!on:
    *!mobile size: 29sp 125sp
    *mobile size: 44sp 105sp

  Panel
    @bind self: e_gameMinimapPanel
    anchors.top: parent.top
    anchors.left: parent.left
    *!mobile size: 229sp 229sp
    *mobile size: 189sp 189sp
    visible: true

    $!on:
      visible: false

    GameMinimap
      id: gameMinimap
      @bind self: e_gameMinimap
      anchors.fill: parent

    Panel
      id: gameMinimapLoadingOverlay
      @bind self: e_gameMinimapLoadingOverlay
      !text: tr('Loading') .. '...'
      anchors.fill: parent
      focusable: false
      visible: false
      phantom: true
      background-color: #0006
      icon-source: /assets/images_ui/game/loading
      icon-align: bottom
      icon-size: 23sp 23sp
      !icon-offset-y: -(dpunittopixels('30sp') + dpunittopixels('1em'))
      font-style: rounded
      font-size: 0.75em
      font-auto-resize: true
      text-align: bottom
      text-padding: 0 5sp 30sp 5sp

    Panel
      id: minimapContainer
      anchors.fill: parent
      image-source: /assets/images_ui/game/minimap/border

  Panel
    id: minimapButtonsTopLeft
    *!mobile width: 29sp
    *mobile width: 44sp
    anchors.top: parent.top
    anchors.right: parent.right
    margin-top: 10sp
    layout: verticalBox
      align: top
      fit-children: true
      spacing: 2sp

    @forward-state on

    MinimapButton
      id: mainMenu
      icon-source: @FontAwesome-flat-14sp-xf0c9
      *!mobile !tooltip: tr('Main Menu') .. '\n(ESC)'
      @slot onClick: modules.game_mainmenu.toggle()

    MinimapButton
      id: minimap
      icon-source: @FontAwesome-flat-14sp-xf279
      *!mobile !tooltip: tr('Minimap') .. '\n(M)'
      @slot onClick: toggle()

      $on:
        visible: false

      $!on:
        visible: true

    *discard MinimapButton
      id: friendList
      icon-source: @FontAwesome-flat-10sp-xf500
      *!mobile !tooltip: tr('Friend List') .. '\n(F)'
      @slot onClick: modules.game_viplist.toggle()

  Panel
    id: minimapButtonsBottomLeft
    *!mobile width: 29sp
    *mobile width: 44sp
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    margin-bottom: 28sp
    visible: true
    layout: verticalBox
      align: bottom
      fit-children: true
      spacing: 2sp

    $!on:
      visible: false

    MinimapButton
      id: zoomIn
      icon-source: @FontAwesome-flat-14sp-xf067
      *!mobile !tooltip: tr('Zoom In') .. '\n(Scroll Up)'
      @slot onClick: zoomIn()

    MinimapButton
      id: zoomOut
      icon-source: @FontAwesome-flat-14sp-xf068
      *!mobile !tooltip: tr('Zoom Out') .. '\n(Scroll Down)'
      @slot onClick: zoomOut()

  BigMinimapButton
    anchors.horizontalCenter: parent.horizontalCenter
    anchors.bottom: parent.bottom
    icon-source: @FontAwesome-flat-16sp-xf279
    @slot onClick: toggle()
    visible: true

    $!on:
      visible: false

MinimapFull < UIWindow
  id: minimapFull
  anchors.fill: parent
  visible: false
  @field blurGameMap: true
  @slotRet onEscape: toggle()

  Panel
    @bind self: e_toggleButton
    *!mobile height: 40sp
    *mobile height: 60sp
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    margin: 8sp
    layout: horizontalBox
      fit-children: true
      align: right
      spacing: 3sp

    BigMinimapButton
      *mobile size: 60sp 60sp
      icon-source: @FontAwesome-flat-16sp-xf279
      @slot onClick: toggle()

  Panel
    @bind self: e_minimapButtons
    *!mobile height: 30sp
    *mobile height: 45sp
    anchors.right: prev.left
    anchors.bottom: parent.bottom
    margin: 8sp
    layout: horizontalBox
      fit-children: true
      align: right
      spacing: 3sp

    MinimapButton
      id: zoomOut
      icon-source: @FontAwesome-flat-14sp-xf068
      *!mobile !tooltip: tr('Zoom Out') .. '\n(Scroll Down)'
      @slot onClick: zoomOut()

    MinimapButton
      id: zoomIn
      icon-source: @FontAwesome-flat-14sp-xf067
      *!mobile !tooltip: tr('Zoom In') .. '\n(Scroll Up)'
      @slot onClick: zoomIn()

  Panel
    id: navKeys
    @bind self: e_navKeys
    height: 2em
    anchors.right: parent.right
    anchors.bottom: parent.bottom
    margin: 15sp 30sp
    visible: false
    layout: horizontalBox
      align: right
      fit-children: true
      spacing: 2.5em

    MenuNavKeyPanel
      @bind self: e_zoomOutKeyPanel
      @slot onClick: zoomOut()
      MenuNavKeyIconPanel
        id: icons
      MenuNavKeyLabel
        !text: tr('Zoom Out')

    MenuNavKeyPanel
      @bind self: e_zoomInKeyPanel
      @slot onClick: zoomIn()
      MenuNavKeyIconPanel
        id: icons
      MenuNavKeyLabel
        !text: tr('Zoom In')

    MenuNavKeyPanel
      @bind self: e_backKeyPanel
      @slot onClick: toggle()
      MenuNavKeyIconPanel
        id: icons
      MenuNavKeyLabel
        !text: tr('Back')
